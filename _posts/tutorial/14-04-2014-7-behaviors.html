---
title: 7. Behaviors
permalink: /tutorial/behaviors.html
category: tutorial
layout: default
---

<div class="page-header">
	<h1>
		Behaviors
	</h1>
</div>

<div class="row">
	<div class="col-md-12">
		<p>
			Behaviors will give a lot of power to your application. This also holds our key in DCI (Data, Context, Interaction)
			<br/> As you remember we have the data and the result in our context, and we can interact with this and do things accordingly
			<br/> for an example we are going to show only the items a logged in user can access. This will change the Row and Rowset objects.
		</p>

	{% highlight javascript linenos %}
	var Rowset  = require('raddish').Rowset;
	var Base    = require('raddish').Base;
	var util    = require('util');
	var async   = require('async');

	function ExampleBehavior() {

	};

	util.inherits(ExampleBehavior, Base);

	ExampleBehavior.prototype.onAfterGet = function(context) {
		return new Promise(function(resolve, reject) {
			if(context.result.data instanceof Rowset) {
				// We have a rowset so we will loop through the rows and check if they can access it.
				async.each(context.result.data.rows, function(item, done) {
					item.then(function(row) {
						if(row.data.access == 1 && !context.user) {
							var index = context.result.data.rows.indexOf(item);

							context.result.data.rows.splice(index, 1);
						}

						done();
					});
				}, function(err) {
					resolve(context);
				});

			} else {
				// We have a row object when we don't have access we clear all the data.
				var row = context.result.data;

				if(row.data.access == 1 && !context.user) {
					// We don't have permission so set all the data to null

					for(var index in row.data) {
						row.data[index] = null;
					}

					resolve(context);
				}
			}
		});
	};

	module.exports = ExampleBehavior;{% endhighlight %}
		<p>
			This is an example of how to use the async part of the framework and although it is async it doesn't slow the system down to much and will return the expected result.
			<br/> You have many more functions in behaviors there are different behavior functions per object. <br/>
			Here is a list for controller behavior functions
		</p>
		<ul>
			<li>onBeforeGet</li>
			<li>onAfterGet</li>
			<li>onBeforePost</li>
			<li>onAfterPost</li>
			<li>onBeforeDelete</li>
			<li>onAfterDelete</li>
		</ul>
		<p>
			And the list with Table behavior functions
		</p>
		<ul>
			<li>onBeforeSelect</li>
			<li>onAfterSelect</li>
			<li>onBeforeInsert</li>
			<li>onAfterInsert</li>
			<li>onBeforeUpdate</li>
			<li>onAfterUpdate</li>
			<li>onBeforeDelete</li>
			<li>onAfterDelete</li>
		</ul>
		<p class="text-info">
			Controller <br/>
				&nbsp;On before functions have raw post data in the context <br/>
				&nbsp;On after functions have a row or rowset object and state data.
		</p>
		<p class="text-info">
			Table <br/>
				&nbsp;On before functions have a query object <br/>
				&nbsp;On after functions have raw database data.
		</p>
	</div>
</div>