---
layout: default
---

<div class="api">
    <aside class="sidebar">
        <ul>
                <li {% if page.url == '../classes/AbstractAdapter.html' %} class="active" {% endif %}>
                    <a href="../classes/AbstractAdapter.html">
                        AbstractAdapter
                    </a>
                </li>
                <li {% if page.url == '../classes/AbstractDispatcher.html' %} class="active" {% endif %}>
                    <a href="../classes/AbstractDispatcher.html">
                        AbstractDispatcher
                    </a>
                </li>
                <li {% if page.url == '../classes/Application.html' %} class="active" {% endif %}>
                    <a href="../classes/Application.html">
                        Application
                    </a>
                </li>
                <li {% if page.url == '../classes/CommandBehavior.html' %} class="active" {% endif %}>
                    <a href="../classes/CommandBehavior.html">
                        CommandBehavior
                    </a>
                </li>
                <li {% if page.url == '../classes/CommandChain.html' %} class="active" {% endif %}>
                    <a href="../classes/CommandChain.html">
                        CommandChain
                    </a>
                </li>
                <li {% if page.url == '../classes/CommandContext.html' %} class="active" {% endif %}>
                    <a href="../classes/CommandContext.html">
                        CommandContext
                    </a>
                </li>
                <li {% if page.url == '../classes/Controller.html' %} class="active" {% endif %}>
                    <a href="../classes/Controller.html">
                        Controller
                    </a>
                </li>
                <li {% if page.url == '../classes/ControllerAbstract.html' %} class="active" {% endif %}>
                    <a href="../classes/ControllerAbstract.html">
                        ControllerAbstract
                    </a>
                </li>
                <li {% if page.url == '../classes/DefaultAuthenticator.html' %} class="active" {% endif %}>
                    <a href="../classes/DefaultAuthenticator.html">
                        DefaultAuthenticator
                    </a>
                </li>
                <li {% if page.url == '../classes/Dispatcher.html' %} class="active" {% endif %}>
                    <a href="../classes/Dispatcher.html">
                        Dispatcher
                    </a>
                </li>
                <li {% if page.url == '../classes/Inflector.html' %} class="active" {% endif %}>
                    <a href="../classes/Inflector.html">
                        Inflector
                    </a>
                </li>
                <li {% if page.url == '../classes/Mixin.html' %} class="active" {% endif %}>
                    <a href="../classes/Mixin.html">
                        Mixin
                    </a>
                </li>
                <li {% if page.url == '../classes/Model.html' %} class="active" {% endif %}>
                    <a href="../classes/Model.html">
                        Model
                    </a>
                </li>
                <li {% if page.url == '../classes/ModelAbstract.html' %} class="active" {% endif %}>
                    <a href="../classes/ModelAbstract.html">
                        ModelAbstract
                    </a>
                </li>
                <li {% if page.url == '../classes/MongoAdapter.html' %} class="active" {% endif %}>
                    <a href="../classes/MongoAdapter.html">
                        MongoAdapter
                    </a>
                </li>
                <li {% if page.url == '../classes/MysqlAdapter.html' %} class="active" {% endif %}>
                    <a href="../classes/MysqlAdapter.html">
                        MysqlAdapter
                    </a>
                </li>
                <li {% if page.url == '../classes/ObjectIdentifier.html' %} class="active" {% endif %}>
                    <a href="../classes/ObjectIdentifier.html">
                        ObjectIdentifier
                    </a>
                </li>
                <li {% if page.url == '../classes/ObjectLoader.html' %} class="active" {% endif %}>
                    <a href="../classes/ObjectLoader.html">
                        ObjectLoader
                    </a>
                </li>
                <li {% if page.url == '../classes/ObjectManager.html' %} class="active" {% endif %}>
                    <a href="../classes/ObjectManager.html">
                        ObjectManager
                    </a>
                </li>
                <li {% if page.url == '../classes/Plugin.html' %} class="active" {% endif %}>
                    <a href="../classes/Plugin.html">
                        Plugin
                    </a>
                </li>
                <li {% if page.url == '../classes/RaddishError.html' %} class="active" {% endif %}>
                    <a href="../classes/RaddishError.html">
                        RaddishError
                    </a>
                </li>
                <li {% if page.url == '../classes/Role.html' %} class="active" {% endif %}>
                    <a href="../classes/Role.html">
                        Role
                    </a>
                </li>
                <li {% if page.url == '../classes/Router.html' %} class="active" {% endif %}>
                    <a href="../classes/Router.html">
                        Router
                    </a>
                </li>
                <li {% if page.url == '../classes/Row.html' %} class="active" {% endif %}>
                    <a href="../classes/Row.html">
                        Row
                    </a>
                </li>
                <li {% if page.url == '../classes/RowAbstract.html' %} class="active" {% endif %}>
                    <a href="../classes/RowAbstract.html">
                        RowAbstract
                    </a>
                </li>
                <li {% if page.url == '../classes/Rowset.html' %} class="active" {% endif %}>
                    <a href="../classes/Rowset.html">
                        Rowset
                    </a>
                </li>
                <li {% if page.url == '../classes/RowsetAbstract.html' %} class="active" {% endif %}>
                    <a href="../classes/RowsetAbstract.html">
                        RowsetAbstract
                    </a>
                </li>
                <li {% if page.url == '../classes/Socket.html' %} class="active" {% endif %}>
                    <a href="../classes/Socket.html">
                        Socket
                    </a>
                </li>
                <li {% if page.url == '../classes/SqliteAdapter.html' %} class="active" {% endif %}>
                    <a href="../classes/SqliteAdapter.html">
                        SqliteAdapter
                    </a>
                </li>
                <li {% if page.url == '../classes/States.html' %} class="active" {% endif %}>
                    <a href="../classes/States.html">
                        States
                    </a>
                </li>
                <li {% if page.url == '../classes/Table.html' %} class="active" {% endif %}>
                    <a href="../classes/Table.html">
                        Table
                    </a>
                </li>
                <li {% if page.url == '../classes/ViewAbstract.html' %} class="active" {% endif %}>
                    <a href="../classes/ViewAbstract.html">
                        ViewAbstract
                    </a>
                </li>
                <li {% if page.url == '../classes/ViewJson.html' %} class="active" {% endif %}>
                    <a href="../classes/ViewJson.html">
                        ViewJson
                    </a>
                </li>
        </ul>    </aside>

    <article>
        <h1 class="file-heading">File: lib/raddish/raddish.js</h1>
        
        <div class="file">
            <pre class="code prettyprint linenums">
        &quot;use strict&quot;;
        
        var Application     = require(&#x27;../application/application&#x27;),
            http            = require(&#x27;http&#x27;),
            https           = require(&#x27;https&#x27;),
            Router          = require(&#x27;../router/router&#x27;),
            config          = {},
            cluster         = require(&#x27;cluster&#x27;),
            fs              = require(&#x27;fs&#x27;),
            Notifier        = require(&#x27;update-notifier&#x27;),
            Plugin          = require(&#x27;../plugin/plugin&#x27;),
            app;
        
        
        /**
         * The main class of our framework. This object will help with registring our applications.
         * @constructor
         */
        function Raddish() {
            this.server = undefined;
        };
        
        /**
         * This will set an application handler.
         *
         * @method setApplication
         * @param {String} alias The alias of the application
         * @param {String} path The path to the application.
         * @returns {*}
         */
        Raddish.prototype.setApplication = function(alias, path) {
            var plugins = new Plugin();
            var self    = this;
        
            return plugins.get(&#x27;application&#x27;)
                .then(function(plugins) {
                    return plugins.execute(&#x27;before.register&#x27;, alias, path);;
                })
                .then(function(plugins) {
                    app = Application.setApplication(alias, path)
                    app = app.getApplication(alias);
        
                    return [plugins, app];
                })
                .spread(function(plugins, app) {
                    return plugins.execute(&#x27;after.register&#x27;, app);;
                })
                .then(function(plugins) {
                    return self;
                });
        };
        
        /**
         * This function will set the config of Raddish which is located in a JSON file..
         *
         * @method setConfig
         * @param config
         */
        Raddish.prototype.setConfig = function(cnf) {
            var tmp = fs.readFileSync(cnf);
        
            config = JSON.parse(tmp);
        };
        
        /**
         * This function will get a single config value,
         * if there is no key given it will return the complete config.
         *
         * @method getConfig
         * @param {Name} key The key of the config value
         * @returns {*}
         */
        Raddish.prototype.getConfig = function(key) {
            if(key) {
                key = key.split(&#x27;.&#x27;);
        
                var base = config;
                for(var index in key) {
                    if(base[key[index]]) {
                        base = base[key[index]];
                    } else {
                        return false;
                    }
                }
        
                return base;
            } else {
                return config;
            }
        };
        
        /**
         * This will start the listener for http traffic, and will route it to the correct application (if there it isn&#x27;t a file)
         *
         * @param {Int} port A override for the port given in the config.
         */
        Raddish.prototype.start = function(port) {
            var Threads = require(&#x27;../threads/threads&#x27;);
            var plugins = new Plugin();
            var self    = this;
        
            plugins.get(&#x27;system&#x27;)
                .then(function(plugins) {
                    return plugins.execute(&#x27;before.start&#x27;);
                })
                .then(function(plugins) {
                    if(!port &amp;&amp; !config.port) {
                        throw new Error(&#x27;No port found to start on!&#x27;);
                    }
        
                    if(config.threads) {
                        if(!cluster.isMaster) {
                            self.startWebServer(port);
                        } else {
                            console.log(&#x27;Server started on port: &#x27; + (port || config.port));
                        }
                    } else {
                        self.startWebServer(port);
                        console.log(&#x27;Server started on port: &#x27; + (port || config.port));
                    }
        
                    if(config.threads) {
                        if(config.socketio &amp;&amp; !cluster.isMaster) {
                            Socket.start();
                        } else if(config.socketio &amp;&amp; cluster.isMaster) {
                            console.log(&#x27;Socket.io started on port: &#x27; + (config.socketio.port || 1338));
                        }
                    } else {
                        if(config.socketio) {
                            Socket.start();
                            console.log(&#x27;Socket.io started on port: &#x27; + (config.socketio.port || 1338));
                        }
                    }
        
                    return plugins;
                })
                .then(function() {
                    plugins.execute(&#x27;after.start&#x27;);
                });
        };
        
        /**
         * This function will start the webserver
         * with the right specification.
         *
         * @method startWebServer
         * @param {Int} port The late port of the server.
         */
        Raddish.prototype.startWebServer = function(port) {
            var cnf     = undefined;
            var route   = function(req, res) {
                new Router().route(req, res);
            }
        
            if(config.ssl) {
                cnf = {
                    key: fs.readFileSync(config.ssl.key),
                    cert: fs.readFileSync(config.ssl.cert)
                };
            }
        
            this.server = cnf ? https.createServer(cnf, route) : http.createServer(route);
            this.server.listen(port || config.port);
        };
        
        /**
         * This function will check if there is an update available from NPM.
         * If there is an update, then the user should update manually.
         *
         * @method checkUpdate
         */
        Raddish.prototype.checkUpdate = function() {
            if(!config.threads || cluster.isMaster) {
                var pkg = require(&#x27;../../package.json&#x27;),
                    notifier = Notifier({pkg: pkg});
        
                if (notifier.update) {
                    notifier.notify();
                }
            }
        }
        
        module.exports = new Raddish();
            </pre>
        </div>
    </article>
</div>